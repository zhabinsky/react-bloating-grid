"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_useSelectedBox3=_interopRequireDefault(require("./useSelectedBox")),_utils=require("./utils"),_isServer=_interopRequireDefault(require("./isServer")),_withResolvedBreakpoints=_interopRequireDefault(require("./withResolvedBreakpoints"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function(){return cache},cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj["default"]=obj,cache&&cache.set(obj,newObj),newObj}function _extends(){return _extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i],source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target},_extends.apply(this,arguments)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null==arguments[i]?{}:arguments[i],i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))});return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){if(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!(i&&_arr.length===i));_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i["return"]||_i["return"]()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=_objectWithoutPropertiesLoose(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],!(0<=excluded.indexOf(key))&&Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}var CustomTypes={NumberOrBreakpointObject:_propTypes["default"].oneOfType([_propTypes["default"].number,_propTypes["default"].object]),BoolOrBreakpointObject:_propTypes["default"].oneOfType([_propTypes["default"].bool,_propTypes["default"].object])},propTypes={id:_propTypes["default"].string,// auto-generated
children:_propTypes["default"].arrayOf(_propTypes["default"].node),style:_propTypes["default"].object,styleChild:_propTypes["default"].object,gridColumns:CustomTypes.NumberOrBreakpointObject.isRequired,gridGap:CustomTypes.NumberOrBreakpointObject,gridRowGap:CustomTypes.NumberOrBreakpointObject,gridColumnGap:CustomTypes.NumberOrBreakpointObject,className:_propTypes["default"].string,classNameChild:_propTypes["default"].string,classNameChildSelected:_propTypes["default"].string,trimLastRow:CustomTypes.BoolOrBreakpointObject,// makes there are no empty slots in rows
disable:CustomTypes.BoolOrBreakpointObject,disableMagnification:CustomTypes.BoolOrBreakpointObject,disableMovement:CustomTypes.BoolOrBreakpointObject,effectScale:CustomTypes.NumberOrBreakpointObject,effectScaleMovement:CustomTypes.NumberOrBreakpointObject,effectScaleMagnification:CustomTypes.NumberOrBreakpointObject},defaultProps={id:void 0,children:[],style:{},styleChild:{transition:"all 0.4s ease-out"},gridColumns:5,gridGap:20,gridRowGap:20,gridColumnGap:20,className:"",classNameChild:"",classNameChildSelected:"",trimLastRow:!1,disable:!1,disableMagnification:!1,disableMovement:!1,effectScale:1,effectScaleMovement:1,effectScaleMagnification:1};function BloatingBase(props){var _props$id=props.id,containerId=void 0===_props$id?(0,_utils.generateID)():_props$id,children=props.children,style=props.style,styleChild=props.styleChild,gridColumns=props.gridColumns,gridGap=props.gridGap,propRowGap=props.gridRowGap,propColumnGap=props.gridColumnGap,className=props.className,classNameChild=props.classNameChild,classNameChildSelected=props.classNameChildSelected,trimLastRow=props.trimLastRow,disable=props.disable,propDisableMagnification=props.disableMagnification,propDisableMovement=props.disableMovement,effectScale=props.effectScale,propEffectScaleMovement=props.effectScaleMovement,propEffectScaleMagnification=props.effectScaleMagnification,rest=_objectWithoutProperties(props,["id","children","style","styleChild","gridColumns","gridGap","gridRowGap","gridColumnGap","className","classNameChild","classNameChildSelected","trimLastRow","disable","disableMagnification","disableMovement","effectScale","effectScaleMovement","effectScaleMagnification"]),_useState=(0,_react.useState)(containerId),_useState2=_slicedToArray(_useState,1),id=_useState2[0],gridRowGap=propRowGap||gridGap,gridColumnGap=propColumnGap||gridGap,disableMagnification=null===disable?propDisableMagnification:disable,disableMovement=null===disable?propDisableMovement:disable,effectScaleMovement=null===effectScale?propEffectScaleMovement:effectScale,effectScaleMagnification=null===effectScale?propEffectScaleMagnification:effectScale,nChildren=children.length,_useSelectedBox=(0,_useSelectedBox3["default"])(id,gridColumns,gridRowGap,gridColumnGap,nChildren),_useSelectedBox2=_slicedToArray(_useSelectedBox,3),selected=_useSelectedBox2[0],onMouseMove=_useSelectedBox2[1],reset=_useSelectedBox2[2],containerStyle=_objectSpread({display:"grid",gridTemplateColumns:"repeat(".concat(gridColumns,", 1fr)").trim(),gridRowGap:gridRowGap,gridColumnGap:gridColumnGap},style),coordinatesSelected=(0,_utils.getCoordinates)(selected,gridColumns);if("production"!==process.env.NODE_ENV&&!Array.isArray(children))/** 
     * Throw an error in development 
     * if the children are not an array 
     * */throw Error("Bloating.children must be an array");var trimFilter=createTrimFilter(gridColumns,trimLastRow,nChildren);return _react["default"].createElement("div",_extends({id:id,style:containerStyle,onMouseMove:onMouseMove,onMouseLeave:reset,className:"bloating-grid ".concat(className).trim()},rest),children.filter(trimFilter).map(function wrapChild(element,index){var coordinatesChild=(0,_utils.getCoordinates)(index,gridColumns),_getVector=_utils.getVector.apply(void 0,_toConsumableArray(coordinatesSelected).concat(_toConsumableArray(coordinatesChild))),_getVector2=_slicedToArray(_getVector,3),xDistance=_getVector2[0],yDistance=_getVector2[1],distance=_getVector2[2],childProps={key:index},style=_objectSpread({},styleChild),className=classNameChild,effectIntensity=_isServer["default"]?1:1/(window.innerWidth/800);if(0<=selected){if(index===selected&&!disableMagnification)style.zIndex=10,style.transform="scale(".concat(1+.4*effectIntensity*effectScaleMagnification,")"),className+=" "+classNameChildSelected;else if(!disableMovement){var coeficient=-5*(5/distance)*effectIntensity*effectScaleMovement;style.transform="translate(".concat(xDistance*coeficient,"px, ").concat(yDistance*coeficient,"px)")}}return className=className.trim(),0<className.length&&(childProps.className=className),childProps.style=style,_react["default"].createElement("div",childProps,element)}))}var Bloating=(0,_withResolvedBreakpoints["default"])(BloatingBase,["gridColumns","gridGap","gridRowGap","gridColumnGap","trimLastRow","effectScale","effectScaleMovement","effectScaleMagnification","disable","disableMagnification","disableMovement"]);Bloating.propTypes=propTypes,Bloating.defaultProps=defaultProps;var _default=Bloating;exports["default"]=_default;var createTrimFilter=function(gridColumns,trimLastRow,nChildren){if(!trimLastRow)return function(){return!0};return function(_,index){return index<=nChildren-nChildren%gridColumns-1}};